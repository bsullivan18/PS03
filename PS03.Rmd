---
title: 'STAT/MATH 495: Problem Set 03'
author: "Brenna Sullivan"
date: '2017-09-26'
output:
  pdf_document:
    toc: yes
    toc_depth: '2'
  html_document:
    collapsed: no
    smooth_scroll: no
    toc: yes
    toc_depth: 2
    toc_float: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, fig.width=8, fig.height=4.5)
install.packages("rpart")
library(mosaic)
library(broom)
# Load packages
library(tidyverse)
data1 <- read_csv("data/data1.csv")
data2 <- read_csv("data/data2.csv")
```


# Question

For both `data1` and `data2` tibbles (a tibble is a data frame with some
[metadata](https://blog.rstudio.com/2016/03/24/tibble-1-0-0#tibbles-vs-data-frames) attached:

* Find the splines model with the best out-of-sample predictive ability.
* Create a visualizaztion arguing why you chose this particular model.
* Create a visualizaztion of this model plotted over the given $(x_i, y_i)$ points for $i=1,\ldots,n=3000$.
* Give your estimate $\widehat{\sigma}$ of $\sigma$ where the noise component $\epsilon_i$ is distributed with mean 0 and standard deviation $\sigma$.


# Data 1
```{r}
library(caret)
library(rpart)
data("data1")
model.single <- rpart(y ~ x, data=data1, method = "class")
predict.single <- predict(object = model.single, newdata = data1, type = "class")
```


```{r}
k.folds <- function(k) {
    folds <- createFolds(data1$y, k = k, list = TRUE, returnTrain = TRUE)
    for (i in 1:k) {
        model <- rpart(y~x, data = data1[folds[[i]],], method = "class")
        predictions <- predict(object = model, newdata = data1[-folds[[i]],], type = "class")
        accuracies.dt <- c(accuracies.dt,confusionMatrix(predictions, data1[-folds[[i]], ]$y)$overall[[1]])
    }
    accuracies.dt
}

set.seed(1)
accuracies.dt <- c()
accuracies.dt <- k.folds(50)
accuracies.dt

mean.accuracies <- mean(accuracies.dt)
```

# Data 2

```{r, echo=TRUE, warning=FALSE, message=FALSE}
head(data2)
```

```{r}
smooth.spline(data2$x, data2$y, df=19) %>%
  broom::augment() %>% 
  ggplot(aes(x=x)) +
  geom_point(aes(y=y)) +
  geom_line(aes(y=.fitted), col="blue", size=1)
```

